# Draw PrizePool Slot 化 + UI 管理 API

## 變更摘要
- Draw 建立時展開玩法/獎級 slots，並支援空 Option（結算前須完整設定）。【F:src/Domain/Gaming/Draws/Draw.cs†L101-L331】【F:src/Domain/Gaming/Draws/DrawPrizePoolItem.cs†L1-L76】
- PrizePool CQRS UseCases：查詢、更新、驗證回傳 DTO 以支援 UI 管理流程。【F:src/Application/Gaming/Draws/PrizePool/Get/GetDrawPrizePoolQuery.cs†L1-L5】【F:src/Application/Gaming/Draws/PrizePool/Get/GetDrawPrizePoolQueryHandler.cs†L1-L42】【F:src/Application/Gaming/Draws/PrizePool/Update/UpdateDrawPrizePoolCommand.cs†L1-L7】【F:src/Application/Gaming/Draws/PrizePool/Update/UpdateDrawPrizePoolCommandHandler.cs†L1-L69】【F:src/Application/Gaming/Draws/PrizePool/Validate/ValidateDrawPrizePoolQuery.cs†L1-L5】【F:src/Application/Gaming/Draws/PrizePool/Validate/ValidateDrawPrizePoolQueryHandler.cs†L1-L50】【F:src/Application/Gaming/Draws/PrizePool/DrawPrizePoolDto.cs†L1-L6】
- Web.Api 新增 Draw 子資源 `/prize-pool` endpoints（遵循 UseCaseInvoker / Produces / RequireAuthorization）。【F:src/Web.Api/Endpoints/Gaming/Draws/GamingDrawEndpoints.cs†L1-L249】
- EF Core mapping 調整為 Option optional（無 migration）。【F:src/Infrastructure/Database/Configurations/Gaming/DrawPrizePoolItemConfiguration.cs†L1-L35】

## 新增錯誤碼
- `Gaming.PrizePoolSlotMissing`：期數缺少獎項槽位。 【F:src/Domain/Gaming/Shared/GamingErrors.cs†L202-L210】
- `Gaming.PrizePoolNotConfigured`：獎項槽位尚未設定。 【F:src/Domain/Gaming/Shared/GamingErrors.cs†L206-L210】

## EF Mapping 調整
- `DrawPrizePoolItem.Option` 改為 optional：允許 slot 只有 tier/playType 沒有 option（slot 模式）。【F:src/Infrastructure/Database/Configurations/Gaming/DrawPrizePoolItemConfiguration.cs†L17-L35】

## 新增 API 路由與 WithName
> Base group: `/api/v1/tenants/{tenantId:guid}/gaming`

| Method | Path | WithName | Auth |
|---|---|---|---|
| GET | `/games/{gameCode}/draws/{drawId:guid}/prize-pool` | `GetGameDrawPrizePool` | `Permission.Gaming.DrawSettle` |
| PUT | `/games/{gameCode}/draws/{drawId:guid}/prize-pool` | `UpdateGameDrawPrizePool` | `Permission.Gaming.DrawSettle` |
| GET | `/games/{gameCode}/draws/{drawId:guid}/prize-pool/validation` | `ValidateGameDrawPrizePool` | `Permission.Gaming.DrawSettle` |

對應實作位置：【F:src/Web.Api/Endpoints/Gaming/Draws/GamingDrawEndpoints.cs†L173-L249】

## 手動驗收步驟（無測試時）
1. 建立 Draw（帶 enabled play types）。確認建立後 prize pool slots 皆存在且 `isConfigured=false`。
2. `GET /prize-pool` 應回傳完整 slots，`option=null`。
3. `PUT /prize-pool` 填寫部分 options。
4. `GET /prize-pool/validation` 應列出未填 slots。
5. 全部填齊後，validation 的 missing 清空，結算前檢查通過。

## 修改/新增檔案清單
- `src/Domain/Gaming/Draws/DrawPrizePoolItem.cs`
- `src/Domain/Gaming/Draws/Draw.cs`
- `src/Domain/Gaming/Draws/ApplyMode.cs`
- `src/Domain/Gaming/Shared/GamingErrors.cs`
- `src/Application/Gaming/Draws/Create/CreateDrawCommandHandler.cs`
- `src/Application/Gaming/Draws/Settle/SettleDrawCommandHandler.cs`
- `src/Application/Gaming/Draws/PrizePool/PrizeOptionDto.cs`
- `src/Application/Gaming/Draws/PrizePool/DrawPrizePoolItemDto.cs`
- `src/Application/Gaming/Draws/PrizePool/DrawPrizePoolDto.cs`
- `src/Application/Gaming/Draws/PrizePool/DrawPrizePoolValidationDto.cs`
- `src/Application/Gaming/Draws/PrizePool/MissingPrizePoolSlotDto.cs`
- `src/Application/Gaming/Draws/PrizePool/DrawPrizePoolMapper.cs`
- `src/Application/Gaming/Draws/PrizePool/Get/GetDrawPrizePoolQuery.cs`
- `src/Application/Gaming/Draws/PrizePool/Get/GetDrawPrizePoolQueryHandler.cs`
- `src/Application/Gaming/Draws/PrizePool/Update/UpdateDrawPrizePoolCommand.cs`
- `src/Application/Gaming/Draws/PrizePool/Update/UpdateDrawPrizePoolItem.cs`
- `src/Application/Gaming/Draws/PrizePool/Update/UpdateDrawPrizePoolCommandHandler.cs`
- `src/Application/Gaming/Draws/PrizePool/Validate/ValidateDrawPrizePoolQuery.cs`
- `src/Application/Gaming/Draws/PrizePool/Validate/ValidateDrawPrizePoolQueryHandler.cs`
- `src/Application/Gaming/Draws/PrizePool/Commands/CloneDrawPrizePoolFromCommand.cs`
- `src/Application/Gaming/Draws/PrizePool/Commands/ApplyPrizePoolTemplateCommand.cs`
- `src/Infrastructure/Database/Configurations/Gaming/DrawPrizePoolItemConfiguration.cs`
- `src/Web.Api/Endpoints/Gaming/Draws/GamingDrawEndpoints.cs`
- `src/Web.Api/Endpoints/Gaming/Requests/UpdateDrawPrizePoolRequest.cs`
- `docs/api/20260115001.md`
